<div id="content" class="span10">
<!-- content starts -->
			
   <div class="row-fluid sortable">		
      <div class="box span12">
         <%= render :partial => 'layouts/title_bar_icons',
                    :locals => { :header_title => "Vulnerability Notices",
                                 :header_link  => "#" }
         %>
         <div class="box-content">
            <table id="dataTable" class="table table-striped table-bordered bootstrap-datatable">
               <thead>
	                <tr>
	                   <th>ID</th>
                     <th>Device</th>
		                 <th>CVSS Score</th>
                     <th>Date</th>
                     <th>Summary</th>
	                </tr>
	             </thead>  
               <tfoot>
                  <tr>
                     <th rowspan="1" colspan="1"></th>
                     <th rowspan="1" colspan="1"></th>
                     <th rowspan="1" colspan="1"></th>
                     <th rowspan="1" colspan="1"></th>
                     <th rowspan="1" colspan="1"></th>
                  </tr>
               </tfoot> 
	             <tbody>
                  <% @cveAlertRecs.each do |rec| %>
                     <tr>
                        <td><%= link_to rec.vuln_id, "http://web.nvd.nist.gov/view/vuln/search-results?query=#{rec.vuln_id}&search_type=all&cves=on", :target => "_blank" %></td>
                        <td><%= link_to rec.mac, :action=> "device_details", :device =>  rec.mac %></td>

                        <% 
                           labelClass = "label"
                           score = rec.score.to_i
                           if    score.between?(0, 3) then labelClass += " label-info"
                           elsif score.between?(4, 5) then labelClass += " label-success"
                           elsif score.between?(6, 9) then labelClass += " label-warning"
                           elsif score == 10          then labelClass += " label-important"
                           end
                        %>
                        <td><span class=<%= labelClass %> ><%= sprintf("%5.2f", rec.score) %></span></td>
                        <td><%= rec.date %></td>
                        <td><%= rec.summary %></td>
                     </tr>
                  <% end %>
               </tbody>
            </table>

         </div> <!-- box-content -->
      </div> <!-- box span12 -->
   </div><!-- row-fluid sortable -->
</div><!-- content ends -->

<script type="text/javascript">
//datatable
$(document).ready(function() {
  var oTable = $('#dataTable').dataTable({
      "sDom": "<'row-fluid'<'span6'l><'span6'f>r>t<'row-fluid'<'span12'i><'span12 center'p><R>>",
      "bStateSave": true,
      "bJQueryUI": true,
      "sPaginationType": "bootstrap",
      "oLanguage": {
      "sSearch": "Search all columns: ",
      "sLengthMenu": "_MENU_ records per page"
      }
    } );

/* Add a select menu for each TH element in the table footer */
  $("tfoot th").each( function ( i ) {
    switch(i)
    {
      case 0:
      case 1:
      case 2:
        this.innerHTML = fnCreateSelect( oTable.fnGetColumnData(i, true) );
        break;
      case 3:
        this.innerHTML = fnCreateSelect( oTable.fnGetColumnData(i, false, true) );
        break;
      default: 
        this.innerHTML = fnCreateSelect( oTable.fnGetColumnData(i) );
    }

    $('select', this).change( function () {
      oTable.fnFilter( $(this).val(), i );
    } );
  } );

});
</script>
