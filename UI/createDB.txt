CREATE TABLE ALERTDB       ( TimeStamp      TIMESTAMP default (strftime('%s', 'now')),
                             EventID        INTEGER,
                             SrcMac         VARCHAR,
                             DstMac         VARCHAR,
                             Protocol       INTEGER,
                             SrcIP          VARCHAR,
                             SrcPort        INTEGER,
                             DestIP         VARCHAR,
                             DestPort       INTEGER,
                             SigID          INTEGER,
                             SigRev         INTEGER,
                             ClassID        INTEGER,
                             Priority       INTEGER,
                             Message        VARCHAR);
CREATE TABLE APPLICATION   ( id                 VARCHAR(30)       PRIMARY KEY,
                             vendor             VARCHAR(30),
                             app_name           VARCHAR(200),
                             version            VARCHAR(30), 
                             revision           VARCHAR(30) );
CREATE TABLE CLASSDB        ( ClassID        INTEGER,
                              ClassName      VARCHAR,
                              Description    VARCHAR);
CREATE TABLE DVI_VULN      ( mac                    VARCHAR(30),
                             vuln_id                VARCHAR(30),  
                             FOREIGN KEY(mac)       REFERENCES DVI(mac),
                             FOREIGN KEY(vuln_id)   REFERENCES VULNERABILITY(id),
                             PRIMARY KEY(mac, vuln_id) );
CREATE TABLE PRODUCT       ( id             VARCHAR(30)       PRIMARY KEY,
                             vendor         VARCHAR(30),
                             os_name        VARCHAR(30),
                             os_version     VARCHAR(30),
                             device_name    VARCHAR(30) );
CREATE TABLE VULNERABILITY ( id                        VARCHAR(30)   PRIMARY KEY, 
                             publication_date          VARCHAR(200),
                             last_modify_date          VARCHAR(200),
                             source                    VARCHAR(30), 
                             summary                   VARCHAR(500), 
                             cvss_score                VARCHAR(10), 
                             cvss_access_vector        VARCHAR(30), 
                             cvss_access_complexity    VARCHAR(30), 
                             cvss_authentication       VARCHAR(30), 
                             cvss_conf_impact          VARCHAR(30), 
                             cvss_integrity_impact     VARCHAR(30), 
                             cvss_availability_impact  VARCHAR(30), 
                             cvss_source               VARCHAR(200), 
                             cvss_gen_date             VARCHAR(10) );
CREATE TABLE VULN_APP      ( vuln_id                VARCHAR(30), 
                             app_id                 VARCHAR(30),                         
                             FOREIGN KEY(vuln_id)   REFERENCES VULNERABILITY(id),
                             FOREIGN KEY(app_id)    REFERENCES APPLICATION(id),
                             PRIMARY KEY(vuln_id, app_id) );
CREATE TABLE VULN_PRODUCT  ( vuln_id                   VARCHAR(30), 
                             product_id                VARCHAR(30),                         
                             FOREIGN KEY(vuln_id)      REFERENCES VULNERABILITY(id),
                             FOREIGN KEY(product_id)   REFERENCES PRODUCT(id),
                             PRIMARY KEY(vuln_id, product_id) );
CREATE TABLE ipstat(TimeStamp timestamp default (strftime('%s', 'now')),DeviceId varchar(30),DestIP varchar,DestPort INTEGER,InBytes INTEGER,OutBytes INTEGER);
CREATE TABLE DEVICEINFO    ( macid               VARCHAR(30) PRIMARY KEY,
                             username            VARCHAR(30),
                             groupname           VARCHAR(30),
                             location            VARCHAR(30),
                             devicetype          VARCHAR(30),
                             operatingsystem     VARCHAR(30),
                             osversion           VARCHAR(20),
                             deviceclass         VARCHAR(30),
                             weight              INTEGER,
                             DVI                 VARCHAR(10),
                             ipaddr              VARCHAR(30),
                             created_at    default  (DATETIME('now','localtime')),
                             updated_at    default  (DATETIME('now','localtime')));
